{
  "question": "Define ML-KEM encapsulation key and where it’s used.",
  "plan": {
    "action": "resolve_definition",
    "reason": "Definition intent detected.",
    "query": null,
    "args": {
      "term": "encapsulation key and where it’s used."
    },
    "mode_hint": "definition"
  },
  "evidence": [
    {
      "score": 0.03028233151183971,
      "chunk_id": "NIST.SP.800-227::p0014::c000",
      "doc_id": "NIST.SP.800-227",
      "start_page": 14,
      "end_page": 14,
      "text": "2. Π.KeyGen (key-generation algorithm): An efficient probabilistic algorithm that ac-\n cepts a parameter set p ∈ Π.ParamSets as input and produces an encapsulation key\nek and a decapsulation key dk as output\n 3. Π.Encaps (encapsulation algorithm): An efficient probabilistic algorithm that ac-\n cepts a parameter set p ∈ Π.ParamSets and an encapsulation key ek as input and\nproduces a shared secret key K and a ciphertext c as output\n 4. Π.Decaps (decapsulation algorithm): An efficient deterministic algorithm that ac-\n cepts a parameter set p ∈ Π.ParamSets, a decapsulation key dk, and a ciphertext c\nas input and produces a shared secret key K′ as output\nAs this section views KEMs purely as mathematical objects, the labels p, ek, dk, c, K, and K′ in Definition 1 are viewed as abstract variables…(truncated)"
    },
    {
      "score": 0.02946236559139785,
      "chunk_id": "NIST.FIPS.203::p0011::c000",
      "doc_id": "NIST.FIPS.203",
      "start_page": 11,
      "end_page": 11,
      "text": "2. Terms, Acronyms, and Notation\n\n2.1 Terms and Definitions approved FIPS-approved and/or NIST-recommended. An algorithm or technique that is either 1) specified in a FIPS or NIST recommendation, 2) adopted in a FIPS or NIST recommendation, or 3) specified in a list of NIST-approved security functions. (KEM) ciphertext A bit string that is produced by encapsulation and used as an input to decapsulation. cryptographic The set of hardware, software, and/or firmware that implements ap- module proved cryptographic functions (including key generation) that are con- tained within the cryptographic boundary of the module. decapsulation The process of applying the Decaps algorithm of a KEM. This algorithm accepts a KEM ciphertext and the decapsulation key as input and pro- duces a shared secret ke…(truncated)"
    },
    {
      "score": 0.015873015873015872,
      "chunk_id": "NIST.SP.800-227::p0013::c001",
      "doc_id": "NIST.SP.800-227",
      "start_page": 13,
      "end_page": 13,
      "text": "History and development. KEMs were first introduced by Cramer and Shoup [11, 12] as a\nbuilding block for constructing highly efficient public-key encryption (PKE) schemes. Their approach combines a KEM with a data encryption mechanism (DEM), which is simply a symmetric-key encryption scheme. The KEM is used to generate a shared secret key, while the DEM is used to encrypt an arbitrarily long stream of messages under that key. This is commonly referred to as the KEM/DEM paradigm (see the HPKE example in Sec. 5.2.1).\nThis approach to constructing highly efficient public-key encryption has been the subject\nof several standards [1, 2, 11, 13–16]. Most recently, KEMs have attracted significant attention due to most of the post-quantum key-establishment candidates in the NIST PQC\nstandardization…(truncated)"
    },
    {
      "score": 0.031754032258064516,
      "chunk_id": "NIST.SP.800-227::p0005::c000",
      "doc_id": "NIST.SP.800-227",
      "start_page": 5,
      "end_page": 5,
      "text": "September 2025\n\nAbstract\n\nA key-encapsulation mechanism (KEM) is a set of algorithms that can be used by two parties under certain conditions to securely establish a shared secret key over a public channel. A shared secret key that is established using a KEM can then be used with symmetric-key cryptographic algorithms to perform essential tasks in secure communications, such as encryption and authentication. This document describes the basic definitions, properties, and applications of KEMs. It also provides recommendations for implementing and using KEMs in a secure manner.\n\nKeywords\n\ncryptography; encryption; key-encapsulation mechanism; key establishment; public-key cryptography.\n\nReports on Computer Systems Technology"
    },
    {
      "score": 0.02946912242686891,
      "chunk_id": "NIST.FIPS.203::p0007::c000",
      "doc_id": "NIST.FIPS.203",
      "start_page": 7,
      "end_page": 7,
      "text": "Federal Information Processing Standards Publication 203\n\nSpecification for the Module-Lattice-Based Key-Encapsulation Mechanism Standard\n\nTable of Contents\n\n1 Introduction 1\n 1.1 Purpose and Scope 1\n 1.2 Context 1\n\n2 Terms, Acronyms, and Notation 2\n 2.1 Terms and Definitions 2\n 2.2 Acronyms 4\n 2.3 Mathematical Symbols 5\n 2.4 Interpreting the Pseudocode 6\n 2.4.1 Data Types 7\n 2.4.2 Loop Syntax 7\n 2.4.3 Arithmetic With Arrays of Integers 7\n 2.4.4 Representations of Algebraic Objects 8\n 2.4.5 Arithmetic With Polynomials and NTT Representations 9\n 2.4.6 Matrices and Vectors 9\n 2.4.7 Arithmetic With Matrices and Vectors 10\n 2.4.8 Applying Algorithms to Arrays, Examples 11\n\n3 Overview of the ML-KEM Scheme 12\n 3.1 Key-Encapsulation Mechanisms 12\n 3.2 The ML-KEM Scheme 13\n 3.3 Requirements for ML…(truncated)"
    },
    {
      "score": 0.015151515151515152,
      "chunk_id": "NIST.SP.800-227::p0043::c000",
      "doc_id": "NIST.SP.800-227",
      "start_page": 43,
      "end_page": 43,
      "text": "quantum-vulnerable, as mentioned in Section 2.2. This KEM is not claimed to be IND-CCAsecure. In similar ways, KEMs could be constructed from RSA-OAEP-basic, as specified in Sec. 9.2.3 of SP 800-56B.\n\n5.1.3. ML-KEM ML-KEM is a high-performance, general-purpose, lattice-based key-encapsulation mechanism. It is a NIST-approved KEM and was standardized in FIPS 203 [3]. ML-KEM is based on CRYSTALS-Kyber [26], which was a candidate in the NIST PQC standardization process. It is believed to satisfy IND-CCA security (Definition 4), even against adversaries in possession of a cryptanalytically relevant quantum computer [17, 27, 28]. The asymptotic, theoretical security of ML-KEM is based on the presumed hardness of the Module Learning with Errors (MLWE) problem [29, 30]. FIPS 203 directly describe…(truncated)"
    },
    {
      "score": 0.014925373134328358,
      "chunk_id": "NIST.SP.800-227::p0043::c001",
      "doc_id": "NIST.SP.800-227",
      "start_page": 43,
      "end_page": 43,
      "text": "5.1.3. ML-KEM ML-KEM is a high-performance, general-purpose, lattice-based key-encapsulation mechanism. It is a NIST-approved KEM and was standardized in FIPS 203 [3]. ML-KEM is based on CRYSTALS-Kyber [26], which was a candidate in the NIST PQC standardization process. It is believed to satisfy IND-CCA security (Definition 4), even against adversaries in possession of a cryptanalytically relevant quantum computer [17, 27, 28]. The asymptotic, theoretical security of ML-KEM is based on the presumed hardness of the Module Learning with Errors (MLWE) problem [29, 30]. FIPS 203 directly describes ML-KEM as a KEM in a manner that closely matches the notation of this document. Specifically, the components of ML-KEM are described in FIPS 203 as follows [3]: • ML-KEM.ParamSets. There are three pa…(truncated)"
    },
    {
      "score": 0.014705882352941176,
      "chunk_id": "NIST.FIPS.204::p0007::c000",
      "doc_id": "NIST.FIPS.204",
      "start_page": 7,
      "end_page": 7,
      "text": "Federal Information Processing Standards Publication 204\n\nSpecification for the Module-Lattice-Based Digital Signature Standard\n\nTable of Contents\n\n1 Introduction 1\n 1.1 Purpose and Scope . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n 1.2 Context . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n\n2 Glossary of Terms, Acronyms, and Symbols 2\n 2.1 Terms and Definitions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n 2.2 Acronyms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n 2.3 Mathematical Symbols . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\n 2.4 Notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . …(truncated)"
    }
  ],
  "draft_answer": "* ML-KEM is a key-encapsulation mechanism standard that was produced during the NIST post-quantum standardization process [c5].\n* An encapsulation key is an output of a probabilistic key-generation algorithm and is represented as a concrete data type such as a bit string [c4].\n* The encapsulation algorithm accepts the encapsulation key as input to produce a shared secret key and a ciphertext [c4].\n* These mechanisms are used by two parties to securely establish a shared secret key over a public channel [c1].\n* The shared secret key established using the encapsulation key is used with symmetric-key algorithms for encryption and authentication [c1].\n* ML-KEM is used as a building block for constructing efficient public-key encryption schemes within the KEM/DEM paradigm [c5].",
  "final_answer": "* ML-KEM is a key-encapsulation mechanism standard that was produced during the NIST post-quantum standardization process [c5].\n* An encapsulation key is an output of a probabilistic key-generation algorithm and is represented as a concrete data type such as a bit string [c4].\n* The encapsulation algorithm accepts the encapsulation key as input to produce a shared secret key and a ciphertext [c4].\n* These mechanisms are used by two parties to securely establish a shared secret key over a public channel [c1].\n* The shared secret key established using the encapsulation key is used with symmetric-key algorithms for encryption and authentication [c1].\n* ML-KEM is used as a building block for constructing efficient public-key encryption schemes within the KEM/DEM paradigm [c5].",
  "citations": [
    {
      "doc_id": "NIST.SP.800-227",
      "start_page": 5,
      "end_page": 5,
      "chunk_id": "NIST.SP.800-227::p0005::c000",
      "key": "c1"
    },
    {
      "doc_id": "NIST.SP.800-227",
      "start_page": 14,
      "end_page": 14,
      "chunk_id": "NIST.SP.800-227::p0014::c000",
      "key": "c4"
    },
    {
      "doc_id": "NIST.SP.800-227",
      "start_page": 13,
      "end_page": 13,
      "chunk_id": "NIST.SP.800-227::p0013::c001",
      "key": "c5"
    }
  ],
  "tool_calls": 1,
  "steps": 4,
  "trace": [
    {
      "type": "step",
      "node": "route",
      "steps": 1,
      "tool_calls": 0
    },
    {
      "type": "plan",
      "action": "resolve_definition",
      "reason": "Definition intent detected.",
      "query": null,
      "args": {
        "term": "encapsulation key and where it’s used."
      },
      "mode_hint": "definition"
    },
    {
      "type": "step",
      "node": "do_tool",
      "steps": 2,
      "tool_calls": 0
    },
    {
      "type": "evidence",
      "n": 8
    },
    {
      "type": "tool",
      "action": "resolve_definition",
      "stats": {
        "n": 8
      },
      "mode_hint": null
    },
    {
      "type": "step",
      "node": "answer",
      "steps": 3,
      "tool_calls": 1
    },
    {
      "type": "answer",
      "citations": 3
    },
    {
      "type": "step",
      "node": "verify_or_refuse",
      "steps": 4,
      "tool_calls": 1
    },
    {
      "type": "final_answer"
    },
    {
      "type": "verify",
      "result": "ok",
      "citations": 3
    }
  ],
  "errors": []
}