(eleven) D:\Waterloo\terms\MDSAI\1B\projects\nist-pqc-rag-agent>python -m rag.ask "What does FIPS 203 specify for ML-KEM key generation?" --show-evidence

=== Evidence (top hits) ===
01. score=0.8083 NIST.FIPS.203 p56-p56 chunk_id=NIST.FIPS.203::p0056::c002 
    C.1 Differences Between CRYSTALS-Kyber and FIPS 203 Initial Public Draft • In the third-round specification [4], the shared secret key was treated as a variable-length value whose length depended on how it would be used ...
02. score=0.8074 NIST.SP.800-227 p43-p43 chunk_id=NIST.SP.800-227::p0043::c001
    5.1.3. ML-KEM ML-KEM is a high-performance, general-purpose, lattice-based key-encapsulation mechanism. It is a NIST-approved KEM and was standardized in FIPS 203 [3]. ML-KEM is based on CRYSTALS-Kyber [26], which was a ...
03. score=0.8041 NIST.IR.8547.ipd p17-p17 chunk_id=NIST.IR.8547.ipd::p0017::c000
    393 schemes they will need to be analyzed on a case-by-case basis with the requirements of the 394 application in mind. NIST intends to offer guidance on various key combiners in the forthcoming 395 SP 800-227, Recommend...
04. score=0.7969 NIST.SP.800-227 p19-p19 chunk_id=NIST.SP.800-227::p0019::c002
    Implementing according to NIST standards. Implementations shall comply with a specific NIST FIPS or SP that specifies the algorithms of the relevant KEM. For example, a conforming implementation of ML-KEM shall comply wi...
05. score=0.7904 NIST.FIPS.203 p44-p44 chunk_id=NIST.FIPS.203::p0044::c001 
    This section describes the three main algorithms of the ML-KEM scheme:  1. Key generation (ML-KEM.KeyGen)  2. Encapsulation (ML-KEM.Encaps)  3. Decapsulation (ML-KEM.Decaps) To instantiate ML-KEM, one must select a param...
06. score=0.7831 NIST.SP.800-227 p10-p10 chunk_id=NIST.SP.800-227::p0010::c000
    approved, this SP describes KEMs both generally and with respect to what is approved. Specific requirements will be clearly noted with “shall” and “must” statements.  1.3. Requirements Conforming implementations of appro...
07. score=0.7778 NIST.FIPS.203 p4-p4 chunk_id=NIST.FIPS.203::p0004::c001   
    Federal Information Processing Standards (FIPS) publications are developed by the National Institute of Standards and Technology (NIST) under 15 U.S.C. 278g-3 and issued by the Secretary of Commerce under 40 U.S.C. 11331...
08. score=0.7750 NIST.FIPS.203 p8-p8 chunk_id=NIST.FIPS.203::p0008::c000   
    4.3.1 Multiplication in the NTT Domain 27  5 The K-PKE Component Scheme 28  5.1 K-PKE Key Generation 28  5.2 K-PKE Encryption 29  5.3 K-PKE Decryption 31  6 Main Internal Algorithms 32  6.1 Internal Key Generation 32  6....

=== Answer ===
ML-KEM key generation is specified as Algorithm 19 (`ML-KEM.KeyGen`) in FIPS 203 [c2], [c5]. The algorithm accepts no input and generates two 32-byte random seeds, $d$ and $z$, internally [c5]. These seeds are used by an internal key generation algorithm to produce an encapsulation key and a decapsulation key [c5]. FIPS 203 requires that the randomness used in this process be generated using NIST-approved techniques [c1], [c4]. Domain separation was added to the underlying `K-PKE.KeyGen` process to prevent the misuse of keys across different security levels when they are saved as seeds [c1]. While the encapsulation key can be made public, the decapsulation key and the generated seeds are sensitive data that must remain private [c5]. The algorithm expects the chosen parameter set—ML-KEM-512, ML-KEM-768, or ML-KEM-1024—to be stored in global variables [c2], [c5]. Additionally, the indices of matrix A in the underlying `K-PKE.KeyGen` match those used in CRYSTALS-Kyber [c1].

=== Citations ===
[c1] NIST.FIPS.203 p56-p56 chunk_id=NIST.FIPS.203::p0056::c002
[c2] NIST.SP.800-227 p43-p43 chunk_id=NIST.SP.800-227::p0043::c001
[c4] NIST.SP.800-227 p19-p19 chunk_id=NIST.SP.800-227::p0019::c002
[c5] NIST.FIPS.203 p44-p44 chunk_id=NIST.FIPS.203::p0044::c001

--------------------------------------